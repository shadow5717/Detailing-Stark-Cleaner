<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STARK CLEANE - Sistema Inteligente</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --primary-light: #64b5f6;
            --secondary: #ff6d00;
            --secondary-dark: #e65100;
            --accent: #00c853;
            --danger: #d32f2f;
            --warning: #ffa000;
            --info: #0288d1;
            --dark: #121212;
            --light: #f5f7fb;
            --gray: #5f6368;
            --gray-light: #e8eaed;
            --sidebar-width: 260px;
            --header-height: 70px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .dark-mode {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --text-secondary: #9e9e9e;
            --border-color: #333;
            --hover-color: #2a2a2a;
        }

        .light-mode {
            --bg-color: #f5f7fb;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-secondary: #5f6368;
            --border-color: #e0e0e0;
            --hover-color: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Login Styles - MEJORADO */
        .screen {
            display: none;
            width: 100%;
            min-height: 100vh;
            padding: 20px;
        }

        .active-screen {
            display: block;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 50%, var(--secondary) 100%);
            padding: 20px;
        }

        .login-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1200px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
            width: 100%;
        }

        .login-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .logo-icon-large {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-weight: bold;
            font-size: 3rem;
            box-shadow: var(--shadow-lg);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .login-title {
            font-size: 3.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, white, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            font-weight: 800;
            letter-spacing: 1px;
        }

        .login-subtitle {
            color: white;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            line-height: 1.5;
        }

        .login-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            width: 100%;
        }

        .login-card {
            flex: 1;
            min-width: 350px;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .login-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .card-header-custom {
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 25px;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .card-body {
            padding: 30px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            color: #333;
            transition: var(--transition);
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
        }

        .form-select {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            color: #333;
            transition: var(--transition);
            font-size: 1rem;
        }

        .input-group {
            display: flex;
            margin-bottom: 25px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .input-group-text {
            padding: 14px 18px;
            background: var(--primary);
            border: none;
            color: white;
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .input-group .form-control {
            border: none;
            border-left: 2px solid rgba(255,255,255,0.3);
            border-radius: 0;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1rem;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-success {
            background: linear-gradient(90deg, var(--accent), #00a046);
            color: white;
        }

        .btn-custom {
            padding: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 12px;
        }

        .w-100 {
            width: 100%;
        }

        .mb-3 {
            margin-bottom: 25px;
        }

        .mb-4 {
            margin-bottom: 30px;
        }

        .user-limit-reached {
            background: rgba(211, 47, 47, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.95rem;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .d-none {
            display: none;
        }

        .login-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
            width: 100%;
            max-width: 1200px;
        }

        .feature {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .feature:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .feature i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .feature h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .feature p {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        @media (max-width: 992px) {
            .login-cards {
                flex-direction: column;
                align-items: center;
            }
            
            .login-card {
                max-width: 500px;
                width: 100%;
            }
            
            .login-title {
                font-size: 2.8rem;
            }
        }

        @media (max-width: 768px) {
            .login-title {
                font-size: 2.2rem;
            }
            
            .login-subtitle {
                font-size: 1.1rem;
                padding: 0 20px;
            }
            
            .card-body {
                padding: 25px 20px;
            }
            
            .login-features {
                grid-template-columns: 1fr;
                padding: 0 20px;
            }
        }

        /* Resto de estilos permanecen iguales */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: bold;
            font-size: 1.4rem;
            color: white;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 14px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 4px solid transparent;
            color: rgba(255, 255, 255, 0.85);
            font-weight: 500;
        }

        .menu-item:hover,
        .menu-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            border-left: 4px solid white;
            color: white;
        }

        .menu-item i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .submenu.active {
            max-height: 300px;
        }

        .submenu-item {
            padding: 12px 20px 12px 60px;
            cursor: pointer;
            transition: var(--transition);
            color: rgba(255, 255, 255, 0.75);
            font-size: 0.9rem;
        }

        .submenu-item:hover {
            background-color: rgba(255, 255, 255, 0.08);
            color: white;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
        }

        .header {
            height: var(--header-height);
            background: var(--card-bg);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 25px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .hamburger {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.3rem;
            cursor: pointer;
            color: var(--text-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background-color: var(--hover-color);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 20px;
            transition: var(--transition);
        }

        .user-profile:hover {
            background-color: var(--hover-color);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .user-role {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Content Area */
        .content {
            padding: 25px;
        }

        .page-title {
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .page-title h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Dashboard Styles */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .card-system {
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 25px;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .card-system::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .card-system:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .barberia {
            background: rgba(26, 115, 232, 0.15);
            color: var(--primary);
        }
        .billar {
            background: rgba(255, 109, 0, 0.15);
            color: var(--secondary);
        }
        .carwash {
            background: rgba(0, 200, 83, 0.15);
            color: var(--accent);
        }
        .config {
            background: rgba(211, 47, 47, 0.15);
            color: var(--danger);
        }

        .card-system h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .card-system p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .card-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .trend-up {
            color: var(--accent);
        }
        .trend-down {
            color: var(--danger);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .stat-card h3 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .chart-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-top: 25px;
            border: 1px solid var(--border-color);
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-color);
        }

        /* Page Styles */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page.active {
            display: block;
        }

        /* Table Styles */
        .table-container {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-top: 20px;
            border: 1px solid var(--border-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 18px 20px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--hover-color);
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        tr:hover {
            background-color: var(--hover-color);
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .badge-success {
            background: rgba(0, 200, 83, 0.15);
            color: var(--accent);
        }

        .badge-warning {
            background: rgba(255, 160, 0, 0.15);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(211, 47, 47, 0.15);
            color: var(--danger);
        }

        .badge-info {
            background: rgba(2, 136, 209, 0.15);
            color: var(--info);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: 0.85rem;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* Form Styles */
        .form-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-top: 20px;
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-color);
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-color);
            color: var(--text-color);
            transition: var(--transition);
            font-size: 0.95rem;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--danger);
        }

        /* POS Styles */
        .pos-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 18px;
            max-height: 600px;
            overflow-y: auto;
            padding: 10px;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            border-color: var(--primary);
        }

        .product-image {
            width: 80px;
            height: 80px;
            background: var(--hover-color);
            border-radius: 10px;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--primary);
        }

        .product-card h4 {
            font-size: 1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .product-card p {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--secondary);
        }

        .cart {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            border: 1px solid var(--border-color);
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .cart-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .cart-items {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .cart-item-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .cart-item-name {
            font-weight: 500;
        }

        .cart-item-price {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--hover-color);
            border: none;
            cursor: pointer;
            font-weight: bold;
            color: var(--text-color);
        }

        .cart-total {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 20px 0;
            text-align: right;
            color: var(--secondary);
        }

        /* Vehicle Cards */
        .vehicles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .vehicle-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 5px solid var(--primary);
            border: 1px solid var(--border-color);
        }

        .vehicle-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .vehicle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .vehicle-placa {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .vehicle-type {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .car {
            background: rgba(26, 115, 232, 0.15);
            color: var(--primary);
        }
        .jeepeta {
            background: rgba(255, 109, 0, 0.15);
            color: var(--secondary);
        }
        .motor {
            background: rgba(0, 200, 83, 0.15);
            color: var(--accent);
        }
        .camion {
            background: rgba(211, 47, 47, 0.15);
            color: var(--danger);
        }

        .vehicle-details {
            margin-bottom: 20px;
        }

        .vehicle-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .vehicle-time {
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 25px;
            overflow-x: auto;
        }

        .tab {
            padding: 14px 24px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            font-weight: 500;
            white-space: nowrap;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .hamburger {
                display: block;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
            .pos-container {
                grid-template-columns: 1fr;
            }
            .user-info {
                display: none;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Factura Styles */
        .invoice-container {
            background: white;
            color: black;
            width: 80mm;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.2;
            margin: 0 auto;
        }

        .invoice-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .invoice-logo {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .invoice-company {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .invoice-address {
            font-size: 10px;
            margin-bottom: 5px;
        }

        .invoice-rnc {
            font-size: 10px;
            margin-bottom: 10px;
        }

        .invoice-details {
            margin-bottom: 10px;
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            padding: 5px 0;
        }

        .invoice-items {
            width: 100%;
            margin-bottom: 10px;
        }

        .invoice-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .invoice-total {
            border-top: 1px dashed #000;
            padding-top: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .invoice-payment {
            margin-bottom: 10px;
        }

        .invoice-footer {
            text-align: center;
            border-top: 1px dashed #000;
            padding-top: 10px;
            font-size: 10px;
        }

        .invoice-number {
            font-weight: bold;
            margin-top: 5px;
        }

        /* Card Payment Section */
        .card-payment-section {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }

        .card-payment-header {
            text-align: center;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .card-payment-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }

        .card-payment-detail {
            display: flex;
            justify-content: space-between;
        }

        .card-payment-label {
            font-weight: bold;
        }

        .card-payment-approval {
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            color: #00c853;
            margin: 15px 0;
        }

        .card-number {
            letter-spacing: 2px;
            font-weight: bold;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 100px;
            right: 25px;
            background: var(--card-bg);
            color: var(--text-color);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--accent);
            z-index: 10000;
            animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s;
            max-width: 350px;
        }
        .notification.error {
            border-left-color: var(--danger);
        }
        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .notification i {
            font-size: 1.2rem;
        }
        .notification.success i {
            color: var(--accent);
        }
        .notification.error i {
            color: var(--danger);
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Jarvis AI Styles */
        .jarvis-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
        }

        .jarvis-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1a73e8, #00c853);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .jarvis-btn.listening {
            background: linear-gradient(135deg, #ff6d00, #d32f2f);
            animation: pulse 1.5s infinite;
        }

        .jarvis-btn:hover {
            transform: scale(1.1);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .jarvis-chat {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 400px;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .jarvis-chat.active {
            display: flex;
        }

        .jarvis-header {
            padding: 15px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .jarvis-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .message.user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message.jarvis {
            align-self: flex-start;
            background: var(--hover-color);
            color: var(--text-color);
            border-bottom-left-radius: 5px;
        }

        .jarvis-input {
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
        }

        .jarvis-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .jarvis-input button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        /* AI Prediction Cards */
        .ai-prediction {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .ai-prediction h4 {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .ai-prediction p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Voice Command Key */
        .voice-key {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 10000;
        }

        .voice-key-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6d00, #d32f2f);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .voice-key-btn:hover {
            transform: scale(1.1);
        }

        /* RNC Field Styles */
        .rnc-field {
            margin-top: 15px;
            padding: 12px;
            background: var(--hover-color);
            border-radius: 8px;
            border-left: 3px solid var(--info);
        }

        .rnc-field label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .rnc-input {
            display: flex;
            gap: 10px;
        }

        .rnc-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 0.9rem;
        }

        .rnc-optional {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
            display: block;
        }
    </style>
</head>
<body class="dark-mode">
    <!-- Login Screen - MEJORADO Y ORGANIZADO -->
    <div class="login-container" id="screen-login">
        <div class="login-wrapper">
            <div class="login-header">
                <div class="login-logo">
                    <div class="logo-icon-large">SC</div>
                    <h1 class="login-title">STARK CLEANE</h1>
                    <p class="login-subtitle">Sistema Inteligente de Gestión - Controla tu barbería, billar y car wash desde una sola plataforma</p>
                </div>
            </div>
            
            <div class="login-cards">
                <div class="login-card">
                    <div class="card-header card-header-custom">
                        <i class="fas fa-sign-in-alt"></i>Iniciar Sesión
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Usuario</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                                <input
                                    type="text"
                                    id="login-username"
                                    class="form-control"
                                    placeholder="Ingrese su usuario"
                                    value="ANTONI"
                                />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contraseña</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input
                                    type="password"
                                    id="login-password"
                                    class="form-control"
                                    placeholder="Ingrese su contraseña"
                                    value="admin123"
                                />
                            </div>
                        </div>
                        <div class="mb-3">
                            <button id="btn-login" class="btn btn-primary w-100 btn-custom">
                                <i class="fas fa-sign-in-alt"></i>Entrar al Sistema
                            </button>
                        </div>
                        <div class="mb-3" style="text-align: center;">
                            <small style="color: #666;">Usuario demo: ANTONI / Contraseña: admin123</small>
                        </div>
                    </div>
                </div>

                <div class="login-card">
                    <div class="card-header card-header-custom">
                        <i class="fas fa-user-plus"></i>Registro de Usuarios
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Usuario</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                                <input
                                    type="text"
                                    id="register-username"
                                    class="form-control"
                                    placeholder="Nuevo usuario"
                                />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contraseña (6+ caracteres)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input
                                    type="password"
                                    id="register-password"
                                    class="form-control"
                                    placeholder="Nueva contraseña"
                                />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Confirmar Contraseña</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input
                                    type="password"
                                    id="register-confirm-password"
                                    class="form-control"
                                    placeholder="Confirme la contraseña"
                                />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Rol</label>
                            <select id="register-role" class="form-select">
                                <option value="vendedor">Vendedor</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <button id="btn-register" class="btn btn-success w-100 btn-custom">
                                <i class="fas fa-user-plus"></i>Registrar Usuario
                            </button>
                        </div>
                        <div id="user-limit-message" class="user-limit-reached d-none">
                            <i class="fas fa-exclamation-circle"></i>
                            Límite de usuarios alcanzado (máximo 3)
                        </div>
                    </div>
                </div>
            </div>

            <div class="login-features">
                <div class="feature">
                    <i class="fas fa-cut"></i>
                    <h3>Barbería Inteligente</h3>
                    <p>Gestión de citas, clientes y servicios con control total</p>
                </div>
                <div class="feature">
                    <i class="fas fa-dice"></i>
                    <h3>Sistema POS</h3>
                    <p>Ventas e inventario en tiempo real con facturación</p>
                </div>
                <div class="feature">
                    <i class="fas fa-car"></i>
                    <h3>Car Wash</h3>
                    <p>Control de vehículos y servicios de lavado</p>
                </div>
                <div class="feature">
                    <i class="fas fa-robot"></i>
                    <h3>Asistente Jarvis</h3>
                    <p>IA integrada para comandos de voz y predicciones</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main System (Hidden until login) -->
    <div class="container" id="mainSystem" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">SC</div>
                    <span>STARK CLEANE</span>
                </div>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i> <span>Dashboard</span>
                </div>
                <div class="menu-item" data-page="barberia">
                    <i class="fas fa-cut"></i>
                    <span>Barbería</span>
                </div>

                <div class="menu-item" data-page="billar">
                    <i class="fas fa-dice"></i>
                    <span>Billar</span>
                </div>

                <div class="menu-item" data-page="carwash">
                    <i class="fas fa-car"></i>
                    <span>Car Wash</span>
                </div>

                <div class="menu-item" data-submenu="configuracion">
                    <i class="fas fa-cog"></i>
                    <span>Configuración</span>
                    <i class="fas fa-chevron-down ml-auto"></i>
                </div>
                <div class="submenu" id="configuracion-submenu">
                    <div class="submenu-item" data-page="config-usuarios">Usuarios</div>
                    <div class="submenu-item" data-page="config-impresora">Impresora</div>
                    <div class="submenu-item" data-page="config-preferencias">Preferencias</div>
                    <div class="submenu-item" data-page="config-tema">Tema</div>
                    <div class="submenu-item" data-page="config-jarvis">Configuración Jarvis</div>
                </div>

                <div class="menu-item" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Cerrar Sesión</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div class="header-left">
                    <div class="hamburger">
                        <i class="fas fa-bars"></i>
                    </div>
                    <div class="header-title" id="headerTitle">Dashboard</div>
                </div>
                <div class="header-actions">
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <div class="user-profile">
                        <div class="user-avatar">A</div>
                        <div class="user-info">
                            <div class="user-name" id="currentUserName">ANTONI</div>
                            <div class="user-role">Propietario</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content">
                <!-- Dashboard -->
                <div class="page active" id="dashboard">
                    <div class="page-title">
                        <h1>Dashboard Principal</h1>
                        <div class="header-actions">
                            <button class="btn btn-outline" id="refreshDashboard">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                    </div>

                    <!-- AI Predictions -->
                    <div class="ai-prediction">
                        <h4><i class="fas fa-robot"></i> PREDICCIÓN INTELIGENTE - JARVIS</h4>
                        <p id="aiPredictionText">Basado en el análisis de datos, se espera un aumento del 15% en las ventas para la próxima semana. Intenta decir "Hola Jarvis" o presiona F2 para comandos de voz.</p>
                    </div>

                    <div class="dashboard-cards">
                        <div class="card-system" data-page="barberia">
                            <div class="card-icon barberia">
                                <i class="fas fa-cut"></i>
                            </div>
                            <h3>Barbería</h3>
                            <p>Gestión de citas y clientes</p>
                            <div class="card-value" id="appointmentsCount">0</div>
                            <div class="card-trend">
                                <span id="appointmentsTrend">No hay citas hoy</span>
                            </div>
                        </div>

                        <div class="card-system" data-page="billar">
                            <div class="card-icon billar">
                                <i class="fas fa-dice"></i>
                            </div>
                            <h3>Billar</h3>
                            <p>Punto de venta e inventario</p>
                            <div class="card-value" id="salesTotal">RD$ 0</div>
                            <div class="card-trend">
                                <span id="salesTrend">No hay ventas hoy</span>
                            </div>
                        </div>

                        <div class="card-system" data-page="carwash">
                            <div class="card-icon carwash">
                                <i class="fas fa-car"></i>
                            </div>
                            <h3>Car Wash</h3>
                            <p>Lavado de vehículos</p>
                            <div class="card-value" id="vehiclesCount">0</div>
                            <div class="card-trend">
                                <span id="vehiclesTrend">No hay vehículos hoy</span>
                            </div>
                        </div>

                        <div class="card-system" data-page="config-tema">
                            <div class="card-icon config">
                                <i class="fas fa-cog"></i>
                            </div>
                            <h3>Configuración</h3>
                            <p>Personaliza tu sistema</p>
                            <div class="card-value">5</div>
                            <div class="card-trend">
                                <span>Opciones disponibles</span>
                            </div>
                        </div>
                    </div>

                    <div class="stats">
                        <div class="stat-card">
                            <h3>Ingresos de Hoy</h3>
                            <div class="stat-value" id="dailyIncome">RD$ 0</div>
                            <div class="stat-trend">
                                <span id="incomeTrend">Sin ingresos hoy</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <h3>Clientes Atendidos</h3>
                            <div class="stat-value" id="customersCount">0</div>
                            <div class="stat-trend">
                                <span id="customersTrend">Sin clientes hoy</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <h3>Productos Vendidos</h3>
                            <div class="stat-value" id="productsSold">0</div>
                            <div class="stat-trend">
                                <span id="productsTrend">Sin productos vendidos</span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">Ventas de la Semana</div>
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>

                <!-- Barbería - Página Completa -->
                <div class="page" id="barberia">
                    <div class="page-title">
                        <h1>Barbería</h1>
                        <button class="btn btn-primary" id="newAppointmentBtn">
                            <i class="fas fa-plus"></i> Nueva Cita
                        </button>
                        <button class="btn btn-success" id="printInvoiceBarberia">
                            <i class="fas fa-print"></i> Imprimir Factura
                        </button>
                    </div>

                    <!-- Tabs de Barbería -->
                    <div class="tabs">
                        <div class="tab active" data-tab="barberia-citas">Registrar Cliente</div>
                        <div class="tab" data-tab="barberia-lista">Lista de Citas</div>
                        <div class="tab" data-tab="barberia-historial">Historial</div>
                    </div>

                    <!-- Contenido de las Tabs -->
                    <div class="tab-content active" id="barberia-citas">
                        <div class="pos-container">
                            <div>
                                <div class="form-container">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="nombre"><i class="fas fa-user"></i> Nombre del Cliente</label>
                                            <input type="text" id="nombre" placeholder="Ingrese el nombre completo">
                                        </div>
                                        <div class="form-group">
                                            <label for="telefono"><i class="fas fa-phone"></i> Teléfono</label>
                                            <input type="text" id="telefono" placeholder="Ingrese el teléfono">
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="barbero"><i class="fas fa-user-tie"></i> Barbero</label>
                                            <input type="text" id="barbero" value="Antoni" readonly>
                                        </div>
                                        <div class="form-group">
                                            <label for="servicio"><i class="fas fa-concierge-bell"></i> Servicio</label>
                                            <input type="text" id="servicio" placeholder="Ej: Corte de cabello, Barba, Tinte">
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="precio"><i class="fas fa-dollar-sign"></i> Precio</label>
                                            <input type="number" id="precio" placeholder="RD$">
                                        </div>
                                        <div class="form-group">
                                            <label for="fecha-hora"><i class="fas fa-calendar-alt"></i> Fecha y Hora</label>
                                            <input type="datetime-local" id="fecha-hora">
                                        </div>
                                    </div>

                                    <button class="btn btn-primary" id="saveAppointmentBtn">
                                        <i class="fas fa-save"></i> Guardar Cita
                                    </button>
                                </div>

                                <!-- Productos/Servicios de Barbería -->
                                <h3 style="margin-top: 30px;">Servicios de Barbería</h3>
                                <div class="products-grid">
                                    <div class="product-card" data-id="10" data-name="Corte de Cabello" data-price="250">
                                        <div class="product-image">
                                            <i class="fas fa-cut"></i>
                                        </div>
                                        <h4>Corte de Cabello</h4>
                                        <p>RD$ 250</p>
                                    </div>
                                    <div class="product-card" data-id="11" data-name="Arreglo de Barba" data-price="150">
                                        <div class="product-image">
                                            <i class="fas fa-user"></i>
                                        </div>
                                        <h4>Arreglo de Barba</h4>
                                        <p>RD$ 150</p>
                                    </div>
                                    <div class="product-card" data-id="12" data-name="Corte y Barba" data-price="350">
                                        <div class="product-image">
                                            <i class="fas fa-user-tie"></i>
                                        </div>
                                        <h4>Corte y Barba</h4>
                                        <p>RD$ 350</p>
                                    </div>
                                    <div class="product-card" data-id="13" data-name="Tinte de Cabello" data-price="400">
                                        <div class="product-image">
                                            <i class="fas fa-paint-brush"></i>
                                        </div>
                                        <h4>Tinte de Cabello</h4>
                                        <p>RD$ 400</p>
                                    </div>
                                    <div class="product-card" data-id="14" data-name="Peinado" data-price="200">
                                        <div class="product-image">
                                            <i class="fas fa-spa"></i>
                                        </div>
                                        <h4>Peinado</h4>
                                        <p>RD$ 200</p>
                                    </div>
                                    <div class="product-card" data-id="15" data-name="Mascarilla Capilar" data-price="300">
                                        <div class="product-image">
                                            <i class="fas fa-hat-cowboy"></i>
                                        </div>
                                        <h4>Mascarilla Capilar</h4>
                                        <p>RD$ 300</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Carrito de Venta Barbería - CON RNC -->
                            <div class="cart">
                                <div class="cart-header">
                                    <div class="cart-title">Carrito de Venta</div>
                                    <div class="badge badge-info" id="cartCountBarberia">0 productos</div>
                                </div>

                                <div class="cart-items" id="cartItemsBarberia">
                                    <!-- Los productos del carrito se cargarán dinámicamente -->
                                </div>

                                <div class="cart-total" id="cartTotalBarberia">Total: RD$ 0</div>

                                <!-- Campo RNC Opcional -->
                                <div class="rnc-field">
                                    <label for="rnc-barberia">
                                        <i class="fas fa-id-card"></i> RNC (Opcional para factura)
                                        <span class="rnc-optional">Dejar vacío para "Consumidor Final"</span>
                                    </label>
                                    <div class="rnc-input">
                                        <input type="text" id="rnc-barberia" placeholder="Ej: 123-45678-9" maxlength="11">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="metodo-pago-barberia">Método de Pago</label>
                                    <select id="metodo-pago-barberia">
                                        <option value="efectivo">Efectivo</option>
                                        <option value="tarjeta">Tarjeta</option>
                                        <option value="transferencia">Transferencia</option>
                                    </select>
                                </div>

                                <div class="form-group" id="cashPaymentSectionBarberia">
                                    <label for="efectivo-recibido-barberia">Efectivo Recibido</label>
                                    <input type="number" id="efectivo-recibido-barberia" placeholder="RD$" value="0">
                                    <div id="cambio-display-barberia" style="margin-top: 10px; font-weight: bold; color: var(--accent);">
                                        Cambio: RD$ 0
                                    </div>
                                </div>

                                <button class="btn btn-primary btn-block" id="printTicketBtnBarberia">
                                    <i class="fas fa-print"></i> Imprimir Ticket
                                </button>
                                <button class="btn btn-success btn-block" id="confirmSaleBtnBarberia">
                                    <i class="fas fa-check"></i> Confirmar Venta
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="barberia-lista">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Cliente</th>
                                        <th>Teléfono</th>
                                        <th>Servicio</th>
                                        <th>Precio</th>
                                        <th>Fecha</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="appointmentsTable">
                                    <!-- Las citas se cargarán dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="barberia-historial">
                        <div class="form-container">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fecha-busqueda">Fecha</label>
                                    <input type="date" id="fecha-busqueda">
                                </div>
                                <div class="form-group">
                                    <label for="servicio-busqueda">Servicio</label>
                                    <input type="text" id="servicio-busqueda" placeholder="Buscar por servicio">
                                </div>
                            </div>

                            <button class="btn btn-primary" id="searchHistoryBtn">
                                <i class="fas fa-search"></i> Buscar
                            </button>
                        </div>

                        <div class="table-container" style="margin-top: 20px">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Cliente</th>
                                        <th>Servicio</th>
                                        <th>Precio</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="historyTable">
                                    <!-- El historial se cargará dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Billar - Página Completa -->
                <div class="page" id="billar">
                    <div class="page-title">
                        <h1>Billar - Sistema POS</h1>
                        <button class="btn btn-secondary" id="newProductBtn">
                            <i class="fas fa-plus"></i> Nuevo Producto
                        </button>
                    </div>

                    <!-- Tabs de Billar -->
                    <div class="tabs">
                        <div class="tab active" data-tab="billar-inventario">Inventario</div>
                        <div class="tab" data-tab="billar-pos">Punto de Venta</div>
                        <div class="tab" data-tab="billar-ventas">Ventas del Día</div>
                        <div class="tab" data-tab="billar-reportes">Reportes</div>
                    </div>

                    <!-- Contenido de las Tabs -->
                    <div class="tab-content active" id="billar-inventario">
                        <div class="page-title">
                            <h2>Inventario de Productos</h2>
                            <div class="header-actions">
                                <button class="btn btn-outline" id="exportProductsBtn">
                                    <i class="fas fa-file-export"></i> Exportar
                                </button>
                                <button class="btn btn-primary" id="addProductBtn">
                                    <i class="fas fa-plus"></i> Agregar Producto
                                </button>
                            </div>
                        </div>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Código</th>
                                        <th>Producto</th>
                                        <th>Categoría</th>
                                        <th>P. Compra</th>
                                        <th>P. Venta</th>
                                        <th>Stock</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTable">
                                    <!-- Los productos se cargarán dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="billar-pos">
                        <div class="page-title">
                            <h2>Punto de Venta</h2>
                            <div class="header-actions">
                                <button class="btn btn-outline" id="clearCartBtn">
                                    <i class="fas fa-trash"></i> Limpiar
                                </button>
                            </div>
                        </div>

                        <div class="pos-container">
                            <div>
                                <div class="form-group">
                                    <label for="codigo-barra"><i class="fas fa-barcode"></i> Código de Barras</label>
                                    <input type="text" id="codigo-barra" placeholder="Escanear código de barras">
                                </div>

                                <h3>Productos Disponibles</h3>
                                <div class="products-grid" id="productsGrid">
                                    <div class="product-card" data-id="1" data-name="Refresco Cola" data-price="100">
                                        <div class="product-image">
                                            <i class="fas fa-wine-bottle"></i>
                                        </div>
                                        <h4>Refresco Cola</h4>
                                        <p>RD$ 100</p>
                                    </div>
                                    <div class="product-card" data-id="2" data-name="Cerveza" data-price="150">
                                        <div class="product-image">
                                            <i class="fas fa-beer"></i>
                                        </div>
                                        <h4>Cerveza</h4>
                                        <p>RD$ 150</p>
                                    </div>
                                    <div class="product-card" data-id="3" data-name="Galletas" data-price="50">
                                        <div class="product-image">
                                            <i class="fas fa-cookie"></i>
                                        </div>
                                        <h4>Galletas</h4>
                                        <p>RD$ 50</p>
                                    </div>
                                    <div class="product-card" data-id="4" data-name="Dulces" data-price="25">
                                        <div class="product-image">
                                            <i class="fas fa-candy-cane"></i>
                                        </div>
                                        <h4>Dulces</h4>
                                        <p>RD$ 25</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Carrito de Venta - CON RNC -->
                            <div class="cart">
                                <div class="cart-header">
                                    <div class="cart-title">Carrito de Venta</div>
                                    <div class="badge badge-info" id="cartCount">0 productos</div>
                                </div>

                                <div class="cart-items" id="cartItems">
                                    <!-- Los productos del carrito se cargarán dinámicamente -->
                                </div>

                                <div class="cart-total" id="cartTotal">Total: RD$ 0</div>

                                <!-- Campo RNC Opcional -->
                                <div class="rnc-field">
                                    <label for="rnc">
                                        <i class="fas fa-id-card"></i> RNC (Opcional para factura)
                                        <span class="rnc-optional">Dejar vacío para "Consumidor Final"</span>
                                    </label>
                                    <div class="rnc-input">
                                        <input type="text" id="rnc" placeholder="Ej: 123-45678-9" maxlength="11">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="metodo-pago">Método de Pago</label>
                                    <select id="metodo-pago">
                                        <option value="efectivo">Efectivo</option>
                                        <option value="tarjeta">Tarjeta</option>
                                        <option value="transferencia">Transferencia</option>
                                    </select>
                                </div>

                                <div class="form-group" id="cashPaymentSection">
                                    <label for="efectivo-recibido">Efectivo Recibido</label>
                                    <input type="number" id="efectivo-recibido" placeholder="RD$" value="0">
                                    <div id="cambio-display" style="margin-top: 10px; font-weight: bold; color: var(--accent);">
                                        Cambio: RD$ 0
                                    </div>
                                </div>

                                <button class="btn btn-primary btn-block" id="printTicketBtn">
                                    <i class="fas fa-print"></i> Imprimir Ticket
                                </button>
                                <button class="btn btn-success btn-block" id="confirmSaleBtn">
                                    <i class="fas fa-check"></i> Confirmar Venta
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="billar-ventas">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Hora</th>
                                        <th>Total</th>
                                        <th>Productos Vendidos</th>
                                        <th>Método de Pago</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="salesTable">
                                    <!-- Las ventas se cargarán dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="billar-reportes">
                        <div class="page-title">
                            <h2>Reportes</h2>
                            <div class="header-actions">
                                <button class="btn btn-success" id="exportExcelBtn">
                                    <i class="fas fa-file-excel"></i> Exportar a Excel
                                </button>
                                <button class="btn btn-danger" id="exportPdfBtn">
                                    <i class="fas fa-file-pdf"></i> Exportar a PDF
                                </button>
                            </div>
                        </div>

                        <div class="form-container">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fecha-inicio">Fecha Inicio</label>
                                    <input type="date" id="fecha-inicio">
                                </div>
                                <div class="form-group">
                                    <label for="fecha-fin">Fecha Fin</label>
                                    <input type="date" id="fecha-fin">
                                </div>
                            </div>

                            <button class="btn btn-primary" id="generateReportBtn">
                                <i class="fas fa-chart-bar"></i> Generar Reporte
                            </button>
                        </div>

                        <div class="stats" style="margin-top: 20px">
                            <div class="stat-card">
                                <h3>Total Vendido</h3>
                                <div class="stat-value" id="totalSold">RD$ 0</div>
                                <div class="stat-trend">
                                    <span id="soldTrend">Sin ventas registradas</span>
                                </div>
                            </div>

                            <div class="stat-card">
                                <h3>Producto Más Vendido</h3>
                                <div class="stat-value" id="topProduct">N/A</div>
                                <div class="stat-trend">
                                    <span id="topProductCount">0 unidades</span>
                                </div>
                            </div>

                            <div class="stat-card">
                                <h3>Categoría Más Popular</h3>
                                <div class="stat-value" id="topCategory">N/A</div>
                                <div class="stat-trend">
                                    <span id="topCategoryPercent">0% de las ventas</span>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <div class="chart-title">Ventas por Categoría</div>
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Car Wash - Página Completa -->
                <div class="page" id="carwash">
                    <div class="page-title">
                        <h1>Car Wash</h1>
                        <button class="btn btn-success" id="newVehicleBtn">
                            <i class="fas fa-plus"></i> Nuevo Vehículo
                        </button>
                    </div>

                    <!-- Tabs de Car Wash -->
                    <div class="tabs">
                        <div class="tab active" data-tab="carwash-registro">Registrar Vehículo</div>
                        <div class="tab" data-tab="carwash-proceso">Vehículos en Proceso</div>
                        <div class="tab" data-tab="carwash-entregados">Vehículos Entregados</div>
                        <div class="tab" data-tab="carwash-historial">Historial</div>
                    </div>

                    <!-- Contenido de las Tabs -->
                    <div class="tab-content active" id="carwash-registro">
                        <div class="pos-container">
                            <div>
                                <div class="form-container">
                                    <div class="form-group">
                                        <label for="tipo-vehiculo"><i class="fas fa-car"></i> Tipo de Vehículo</label>
                                        <select id="tipo-vehiculo">
                                            <option value="">Seleccione tipo</option>
                                            <option value="carro">Carro</option>
                                            <option value="jeepeta">Jeepeta</option>
                                            <option value="motor">Motor</option>
                                            <option value="camion">Camión</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="servicio-vehiculo"><i class="fas fa-concierge-bell"></i> Servicio</label>
                                        <select id="servicio-vehiculo">
                                            <option value="">Seleccione servicio</option>
                                            <option value="lavado-basico">Lavado Básico - RD$ 300</option>
                                            <option value="lavado-completo">Lavado Completo - RD$ 450</option>
                                            <option value="lavado-motor">Lavado de Motor - RD$ 200</option>
                                            <option value="pulido">Pulido - RD$ 600</option>
                                        </select>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="precio-vehiculo"><i class="fas fa-dollar-sign"></i> Precio</label>
                                            <input type="number" id="precio-vehiculo" placeholder="RD$">
                                        </div>
                                        <div class="form-group">
                                            <label for="empleado-vehiculo"><i class="fas fa-user"></i> Empleado (Opcional)</label>
                                            <select id="empleado-vehiculo">
                                                <option value="">Seleccione empleado</option>
                                                <option value="1">Pedro Martínez</option>
                                                <option value="2">José Rodríguez</option>
                                                <option value="3">Ana Sánchez</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hora-entrada"><i class="fas fa-clock"></i> Hora de Entrada</label>
                                        <input type="datetime-local" id="hora-entrada">
                                    </div>

                                    <button class="btn btn-success" id="saveVehicleBtn">
                                        <i class="fas fa-save"></i> Registrar Vehículo
                                    </button>
                                </div>

                                <!-- Servicios de Car Wash -->
                                <h3 style="margin-top: 30px;">Servicios de Lavado</h3>
                                <div class="products-grid">
                                    <div class="product-card" data-id="20" data-name="Lavado Básico" data-price="300">
                                        <div class="product-image">
                                            <i class="fas fa-car"></i>
                                        </div>
                                        <h4>Lavado Básico</h4>
                                        <p>RD$ 300</p>
                                    </div>
                                    <div class="product-card" data-id="21" data-name="Lavado Completo" data-price="450">
                                        <div class="product-image">
                                            <i class="fas fa-car-side"></i>
                                        </div>
                                        <h4>Lavado Completo</h4>
                                        <p>RD$ 450</p>
                                    </div>
                                    <div class="product-card" data-id="22" data-name="Lavado de Motor" data-price="200">
                                        <div class="product-image">
                                            <i class="fas fa-cog"></i>
                                        </div>
                                        <h4>Lavado de Motor</h4>
                                        <p>RD$ 200</p>
                                    </div>
                                    <div class="product-card" data-id="23" data-name="Pulido" data-price="600">
                                        <div class="product-image">
                                            <i class="fas fa-spray-can"></i>
                                        </div>
                                        <h4>Pulido</h4>
                                        <p>RD$ 600</p>
                                    </div>
                                    <div class="product-card" data-id="24" data-name="Aspirado" data-price="150">
                                        <div class="product-image">
                                            <i class="fas fa-wind"></i>
                                        </div>
                                        <h4>Aspirado</h4>
                                        <p>RD$ 150</p>
                                    </div>
                                    <div class="product-card" data-id="25" data-name="Encerado" data-price="400">
                                        <div class="product-image">
                                            <i class="fas fa-sun"></i>
                                        </div>
                                        <h4>Encerado</h4>
                                        <p>RD$ 400</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Carrito de Venta Car Wash - CON RNC -->
                            <div class="cart">
                                <div class="cart-header">
                                    <div class="cart-title">Carrito de Venta</div>
                                    <div class="badge badge-info" id="cartCountCarwash">0 productos</div>
                                </div>

                                <div class="cart-items" id="cartItemsCarwash">
                                    <!-- Los productos del carrito se cargarán dinámicamente -->
                                </div>

                                <div class="cart-total" id="cartTotalCarwash">Total: RD$ 0</div>

                                <!-- Campo RNC Opcional -->
                                <div class="rnc-field">
                                    <label for="rnc-carwash">
                                        <i class="fas fa-id-card"></i> RNC (Opcional para factura)
                                        <span class="rnc-optional">Dejar vacío para "Consumidor Final"</span>
                                    </label>
                                    <div class="rnc-input">
                                        <input type="text" id="rnc-carwash" placeholder="Ej: 123-45678-9" maxlength="11">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="metodo-pago-carwash">Método de Pago</label>
                                    <select id="metodo-pago-carwash">
                                        <option value="efectivo">Efectivo</option>
                                        <option value="tarjeta">Tarjeta</option>
                                        <option value="transferencia">Transferencia</option>
                                    </select>
                                </div>

                                <div class="form-group" id="cashPaymentSectionCarwash">
                                    <label for="efectivo-recibido-carwash">Efectivo Recibido</label>
                                    <input type="number" id="efectivo-recibido-carwash" placeholder="RD$" value="0">
                                    <div id="cambio-display-carwash" style="margin-top: 10px; font-weight: bold; color: var(--accent);">
                                        Cambio: RD$ 0
                                    </div>
                                </div>

                                <button class="btn btn-primary btn-block" id="printTicketBtnCarwash">
                                    <i class="fas fa-print"></i> Imprimir Ticket
                                </button>
                                <button class="btn btn-success btn-block" id="confirmSaleBtnCarwash">
                                    <i class="fas fa-check"></i> Confirmar Venta
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="carwash-proceso">
                        <div class="vehicles-grid" id="vehiclesGrid">
                            <!-- Los vehículos en proceso se cargarán dinámicamente -->
                        </div>
                    </div>

                    <div class="tab-content" id="carwash-entregados">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Vehículo</th>
                                        <th>Tipo</th>
                                        <th>Servicio</th>
                                        <th>Precio</th>
                                        <th>Hora Entrada</th>
                                        <th>Hora Salida</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="completedVehiclesTable">
                                    <!-- Los vehículos entregados se cargarán dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="carwash-historial">
                        <div class="form-container">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fecha-carwash">Fecha</label>
                                    <input type="date" id="fecha-carwash">
                                </div>
                                <div class="form-group">
                                    <label for="tipo-filtro">Tipo de Vehículo</label>
                                    <select id="tipo-filtro">
                                        <option value="">Todos los tipos</option>
                                        <option value="carro">Carro</option>
                                        <option value="jeepeta">Jeepeta</option>
                                        <option value="motor">Motor</option>
                                        <option value="camion">Camión</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="servicio-filtro">Servicio</label>
                                <select id="servicio-filtro">
                                    <option value="">Todos los servicios</option>
                                    <option value="lavado-basico">Lavado Básico</option>
                                    <option value="lavado-completo">Lavado Completo</option>
                                    <option value="lavado-motor">Lavado de Motor</option>
                                    <option value="pulido">Pulido</option>
                                </select>
                            </div>

                            <button class="btn btn-primary" id="searchCarwashBtn">
                                <i class="fas fa-search"></i> Buscar
                            </button>
                        </div>

                        <div class="table-container" style="margin-top: 20px">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Vehículo</th>
                                        <th>Tipo</th>
                                        <th>Servicio</th>
                                        <th>Precio</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="carwashHistoryTable">
                                    <!-- El historial se cargará dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Configuración - Tema -->
                <div class="page" id="config-tema">
                    <div class="page-title">
                        <h1>Configuración - Tema</h1>
                    </div>

                    <div class="form-container">
                        <div class="form-group">
                            <label for="select-tema">Seleccionar Tema</label>
                            <select id="select-tema">
                                <option value="dark">Oscuro</option>
                                <option value="light">Claro</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Vista Previa</label>
                            <div class="card-system">
                                <div class="card-icon barberia">
                                    <i class="fas fa-cut"></i>
                                </div>
                                <h3>Ejemplo de Tarjeta</h3>
                                <p>Esta es una vista previa del tema seleccionado</p>
                            </div>
                        </div>

                        <button class="btn btn-primary" id="saveThemeBtn">
                            <i class="fas fa-save"></i> Guardar Configuración
                        </button>
                    </div>
                </div>

                <!-- Configuración Jarvis -->
                <div class="page" id="config-jarvis">
                    <div class="page-title">
                        <h1>Configuración Jarvis</h1>
                    </div>

                    <div class="form-container">
                        <div class="form-group">
                            <label for="jarvis-voice-key">Tecla de Activación por Voz</label>
                            <input type="text" id="jarvis-voice-key" value="F2" readonly>
                            <small>Presiona F2 para activar el comando de voz</small>
                        </div>

                        <div class="form-group">
                            <label for="jarvis-ai-mode">Modo de IA</label>
                            <select id="jarvis-ai-mode">
                                <option value="avanzado">Avanzado (Recomendado)</option>
                                <option value="basico">Básico</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="jarvis-voice-responses" checked>
                                Respuestas por Voz
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="jarvis-auto-actions" checked>
                                Acciones Automáticas
                            </label>
                        </div>

                        <div class="form-group">
                            <h3>Comandos de Voz Disponibles</h3>
                            <div style="background: var(--hover-color); padding: 15px; border-radius: 8px; margin-top: 10px;">
                                <p><strong>"Abrir [módulo]"</strong> - Navega a cualquier módulo</p>
                                <p><strong>"Registrar cita para [nombre] con [barbero]"</strong> - Crea cita automáticamente</p>
                                <p><strong>"Registrar vehículo [tipo] para [servicio]"</strong> - Registra vehículo automáticamente</p>
                                <p><strong>"Agregar producto [nombre] precio [valor]"</strong> - Agrega producto al inventario</p>
                                <p><strong>"Resumen del día"</strong> - Muestra reporte diario</p>
                                <p><strong>"Buscar [cliente/producto/vehículo]"</strong> - Realiza búsquedas</p>
                            </div>
                        </div>

                        <button class="btn btn-primary" id="saveJarvisConfigBtn">
                            <i class="fas fa-save"></i> Guardar Configuración Jarvis
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para agregar producto -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Agregar Nuevo Producto</div>
                <button class="modal-close" id="closeProductModal">&times;</button>
            </div>
            <div class="form-container">
                <div class="form-row">
                    <div class="form-group">
                        <label for="codigo-barra-producto">Código de Barras</label>
                        <input type="text" id="codigo-barra-producto" placeholder="Ingrese código de barras">
                    </div>
                    <div class="form-group">
                        <label for="nombre-producto">Nombre del Producto</label>
                        <input type="text" id="nombre-producto" placeholder="Ingrese nombre del producto">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="categoria-producto">Categoría</label>
                        <select id="categoria-producto">
                            <option value="">Seleccione categoría</option>
                            <option value="bebidas">Bebidas</option>
                            <option value="snacks">Snacks</option>
                            <option value="licores">Licores</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fecha-ingreso">Fecha de Ingreso</label>
                        <input type="date" id="fecha-ingreso">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="precio-compra">Precio de Compra</label>
                        <input type="number" id="precio-compra" placeholder="RD$">
                    </div>
                    <div class="form-group">
                        <label for="precio-venta">Precio de Venta</label>
                        <input type="number" id="precio-venta" placeholder="RD$">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cantidad-stock">Cantidad en Stock</label>
                        <input type="number" id="cantidad-stock" placeholder="Cantidad">
                    </div>
                    <div class="form-group">
                        <label for="alerta-stock">Alerta de Stock</label>
                        <input type="number" id="alerta-stock" placeholder="Mínimo">
                    </div>
                </div>

                <button class="btn btn-primary" id="saveProductBtn">
                    <i class="fas fa-save"></i> Guardar Producto
                </button>
            </div>
        </div>
    </div>

    <!-- Factura Modal -->
    <div class="modal" id="invoiceModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Factura</div>
                <button class="modal-close" id="closeInvoiceModal">&times;</button>
            </div>
            <div class="invoice-container" id="invoiceContent">
                <!-- La factura se generará aquí -->
            </div>
            <div class="action-buttons" style="margin-top: 20px; justify-content: center;">
                <button class="btn btn-primary" id="printInvoiceBtn">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-success" id="downloadInvoiceBtn">
                    <i class="fas fa-download"></i> Descargar PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Jarvis AI Assistant -->
    <div class="jarvis-container">
        <button class="jarvis-btn" id="jarvisButton">
            <i class="fas fa-robot"></i>
        </button>
        <div class="jarvis-chat" id="jarvisChat">
            <div class="jarvis-header">
                <div>
                    <h3><i class="fas fa-robot"></i> Jarvis</h3>
                    <p>Asistente Inteligente</p>
                </div>
                <button class="modal-close" id="closeJarvis">&times;</button>
            </div>
            <div class="jarvis-messages" id="jarvisMessages">
                <div class="message jarvis">
                    ¡Hola! Soy Jarvis, tu asistente inteligente. ¿En qué puedo ayudarte hoy?
                </div>
            </div>
            <div class="jarvis-input">
                <input type="text" id="jarvisInput" placeholder="Escribe tu mensaje...">
                <button id="sendJarvis">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Voice Command Key -->
    <div class="voice-key">
        <button class="voice-key-btn" id="voiceKeyBtn" title="Presiona F2 para activar voz">
            <i class="fas fa-microphone"></i>
        </button>
    </div>

    <script>
        // =============================================
        // SISTEMA DE USUARIOS Y LOGIN
        // =============================================

        // Sistema de gestión de usuarios
        const UserSystem = {
            init: function() {
                if (!localStorage.getItem('stark_users')) {
                    const defaultUsers = [
                        {
                            id: 1,
                            username: 'ANTONI',
                            password: 'admin123',
                            role: 'admin',
                            created: new Date().toISOString(),
                            avatar: 'A'
                        }
                    ];
                    localStorage.setItem('stark_users', JSON.stringify(defaultUsers));
                }
            },

            getUsers: function() {
                return JSON.parse(localStorage.getItem('stark_users')) || [];
            },

            saveUsers: function(users) {
                localStorage.setItem('stark_users', JSON.stringify(users));
            },

            authenticate: function(username, password) {
                const users = this.getUsers();
                return users.find(user => 
                    user.username === username && user.password === password
                );
            },

            register: function(username, password, role) {
                const users = this.getUsers();
                
                if (users.length >= 3) {
                    return { success: false, message: 'Límite de usuarios alcanzado (máximo 3)' };
                }
                
                if (users.some(user => user.username === username)) {
                    return { success: false, message: 'El usuario ya existe' };
                }
                
                if (password.length < 6) {
                    return { success: false, message: 'La contraseña debe tener al menos 6 caracteres' };
                }
                
                const newUser = {
                    id: Date.now(),
                    username: username,
                    password: password,
                    role: role,
                    created: new Date().toISOString(),
                    avatar: username.charAt(0).toUpperCase()
                };
                
                users.push(newUser);
                this.saveUsers(users);
                
                return { success: true, message: 'Usuario registrado exitosamente' };
            }
        };

        // Inicializar sistema de usuarios
        UserSystem.init();

        // =============================================
        // SISTEMA DE LOGIN Y REGISTRO
        // =============================================

        // Elementos del login
        const loginUsername = document.getElementById('login-username');
        const loginPassword = document.getElementById('login-password');
        const btnLogin = document.getElementById('btn-login');

        // Elementos del registro
        const registerUsername = document.getElementById('register-username');
        const registerPassword = document.getElementById('register-password');
        const registerConfirmPassword = document.getElementById('register-confirm-password');
        const registerRole = document.getElementById('register-role');
        const btnRegister = document.getElementById('btn-register');
        const userLimitMessage = document.getElementById('user-limit-message');

        // Evento de login
        btnLogin.addEventListener('click', function() {
            const username = loginUsername.value.trim();
            const password = loginPassword.value;
            
            if (!username || !password) {
                showNotification('Por favor complete todos los campos', 'error');
                return;
            }
            
            const user = UserSystem.authenticate(username, password);
            
            if (user) {
                loginSuccessful(user);
            } else {
                showNotification('Usuario o contraseña incorrectos', 'error');
            }
        });

        // Evento de registro
        btnRegister.addEventListener('click', function() {
            const username = registerUsername.value.trim();
            const password = registerPassword.value;
            const confirmPassword = registerConfirmPassword.value;
            const role = registerRole.value;
            
            if (!username || !password || !confirmPassword) {
                showNotification('Por favor complete todos los campos', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showNotification('Las contraseñas no coinciden', 'error');
                return;
            }
            
            const result = UserSystem.register(username, password, role);
            
            if (result.success) {
                showNotification(result.message, 'success');
                registerUsername.value = '';
                registerPassword.value = '';
                registerConfirmPassword.value = '';
                updateUserLimitMessage();
            } else {
                showNotification(result.message, 'error');
            }
        });

        // Actualizar mensaje de límite de usuarios
        function updateUserLimitMessage() {
            const users = UserSystem.getUsers();
            if (users.length >= 3) {
                userLimitMessage.classList.remove('d-none');
            } else {
                userLimitMessage.classList.add('d-none');
            }
        }

        updateUserLimitMessage();

        // Función para login exitoso
        function loginSuccessful(user) {
            document.getElementById('screen-login').style.display = 'none';
            document.getElementById('mainSystem').style.display = 'flex';
            
            document.getElementById('currentUserName').textContent = user.username;
            document.querySelector('.user-avatar').textContent = user.avatar;
            
            initApp();
            
            showNotification(`¡Bienvenido ${user.username}! Sistema cargado correctamente`, 'success');
        }

        // =============================================
        // SISTEMA DE NAVEGACIÓN
        // =============================================

        function showPage(pageId) {
            // Ocultar todas las páginas
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Mostrar página seleccionada
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Actualizar menú activo
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-page="${pageId}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
            
            // Actualizar título
            const titles = {
                dashboard: "Dashboard",
                barberia: "Barbería",
                billar: "Billar - Sistema POS", 
                carwash: "Car Wash",
                "config-tema": "Configuración - Tema",
                "config-jarvis": "Configuración Jarvis"
            };
            
            document.getElementById('headerTitle').textContent = titles[pageId] || "STARK CLEANE";
        }

        // =============================================
        // SISTEMA DE PESTAÑAS
        // =============================================

        function setupTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    const container = this.closest('.tabs').parentElement;
                    
                    // Remover activo de todas las pestañas
                    this.parentElement.querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    // Agregar activo a la pestaña clickeada
                    this.classList.add('active');
                    
                    // Ocultar todos los contenidos
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Mostrar contenido correspondiente
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });
        }

        // =============================================
        // SISTEMA DE NOTIFICACIONES
        // =============================================

        function showNotification(message, type = "success") {
            const notification = document.createElement("div");
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-${type === "success" ? "check-circle" : "exclamation-circle"}"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // =============================================
        // SISTEMA DE BASE DE DATOS LOCAL
        // =============================================

        const DB = {
            get: (key) => {
                try {
                    return JSON.parse(localStorage.getItem(key)) || [];
                } catch (error) {
                    return [];
                }
            },

            set: (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (error) {
                    return false;
                }
            },

            add: (key, item) => {
                const data = DB.get(key);
                item.id = Date.now();
                data.push(item);
                return DB.set(key, data) ? item.id : null;
            },

            update: (key, id, updates) => {
                const data = DB.get(key);
                const index = data.findIndex(item => item.id === id);
                if (index !== -1) {
                    data[index] = { ...data[index], ...updates };
                    return DB.set(key, data);
                }
                return false;
            },

            delete: (key, id) => {
                const data = DB.get(key);
                const filtered = data.filter(item => item.id !== id);
                return DB.set(key, filtered);
            }
        };

        // =============================================
        // SISTEMA DE CARRITO CON RNC
        // =============================================

        let cart = [];
        let cartBarberia = [];
        let cartCarwash = [];

        // Función para formatear RNC
        function formatRNC(rnc) {
            if (!rnc) return "CONSUMIDOR FINAL";
            // Formato: 123-45678-9
            rnc = rnc.replace(/\D/g, '');
            if (rnc.length === 9) {
                return rnc.substring(0, 3) + '-' + rnc.substring(3, 8) + '-' + rnc.substring(8);
            }
            return rnc;
        }

        function setupCartBillar() {
            // Agregar productos al carrito
            document.querySelectorAll('#productsGrid .product-card').forEach(card => {
                card.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const productName = this.getAttribute('data-name');
                    const productPrice = parseInt(this.getAttribute('data-price'));
                    
                    addToCart(productId, productName, productPrice);
                });
            });

            // Limpiar carrito
            document.getElementById('clearCartBtn').addEventListener('click', function() {
                cart = [];
                updateCartUI();
                showNotification('Carrito limpiado', 'success');
            });

            // Confirmar venta
            document.getElementById('confirmSaleBtn').addEventListener('click', function() {
                if (cart.length === 0) {
                    showNotification('El carrito está vacío', 'error');
                    return;
                }
                
                const total = getCartTotal();
                const rnc = document.getElementById('rnc').value;
                
                showNotification(`Venta confirmada por RD$ ${total} ${rnc ? 'con RNC: ' + formatRNC(rnc) : ''}`, 'success');
                
                const sale = {
                    total: total,
                    productos: cart.map(item => `${item.quantity}x ${item.name}`).join(', '),
                    fecha: new Date().toISOString(),
                    metodo_pago: document.getElementById('metodo-pago').value,
                    rnc: rnc || null
                };
                
                DB.add('sales', sale);
                
                cart = [];
                updateCartUI();
                document.getElementById('efectivo-recibido').value = '0';
                document.getElementById('rnc').value = '';
                updateChange();
                
                loadSales();
            });

            // Imprimir ticket
            document.getElementById('printTicketBtn').addEventListener('click', function() {
                if (cart.length === 0) {
                    showNotification('No hay productos en el carrito', 'error');
                    return;
                }
                
                printInvoice();
            });

            // Actualizar cambio automáticamente
            document.getElementById('efectivo-recibido').addEventListener('input', function() {
                updateChange();
            });
        }

        function setupCartBarberia() {
            // Agregar productos al carrito de barbería
            document.querySelectorAll('#barberia-citas .products-grid .product-card').forEach(card => {
                card.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const productName = this.getAttribute('data-name');
                    const productPrice = parseInt(this.getAttribute('data-price'));
                    
                    addToCartBarberia(productId, productName, productPrice);
                });
            });

            // Confirmar venta barbería
            document.getElementById('confirmSaleBtnBarberia').addEventListener('click', function() {
                if (cartBarberia.length === 0) {
                    showNotification('El carrito está vacío', 'error');
                    return;
                }
                
                const total = getCartTotalBarberia();
                const rnc = document.getElementById('rnc-barberia').value;
                
                showNotification(`Venta confirmada por RD$ ${total} ${rnc ? 'con RNC: ' + formatRNC(rnc) : ''}`, 'success');
                
                const sale = {
                    total: total,
                    productos: cartBarberia.map(item => `${item.quantity}x ${item.name}`).join(', '),
                    fecha: new Date().toISOString(),
                    metodo_pago: document.getElementById('metodo-pago-barberia').value,
                    rnc: rnc || null
                };
                
                DB.add('sales_barberia', sale);
                
                cartBarberia = [];
                updateCartUIBarberia();
                document.getElementById('efectivo-recibido-barberia').value = '0';
                document.getElementById('rnc-barberia').value = '';
                updateChangeBarberia();
            });

            // Imprimir ticket barbería
            document.getElementById('printTicketBtnBarberia').addEventListener('click', function() {
                if (cartBarberia.length === 0) {
                    showNotification('No hay productos en el carrito', 'error');
                    return;
                }
                
                printBarberiaInvoice();
            });

            // Actualizar cambio barbería
            document.getElementById('efectivo-recibido-barberia').addEventListener('input', function() {
                updateChangeBarberia();
            });
        }

        function setupCartCarwash() {
            // Agregar productos al carrito de car wash
            document.querySelectorAll('#carwash-registro .products-grid .product-card').forEach(card => {
                card.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const productName = this.getAttribute('data-name');
                    const productPrice = parseInt(this.getAttribute('data-price'));
                    
                    addToCartCarwash(productId, productName, productPrice);
                });
            });

            // Confirmar venta car wash
            document.getElementById('confirmSaleBtnCarwash').addEventListener('click', function() {
                if (cartCarwash.length === 0) {
                    showNotification('El carrito está vacío', 'error');
                    return;
                }
                
                const total = getCartTotalCarwash();
                const rnc = document.getElementById('rnc-carwash').value;
                
                showNotification(`Venta confirmada por RD$ ${total} ${rnc ? 'con RNC: ' + formatRNC(rnc) : ''}`, 'success');
                
                const sale = {
                    total: total,
                    productos: cartCarwash.map(item => `${item.quantity}x ${item.name}`).join(', '),
                    fecha: new Date().toISOString(),
                    metodo_pago: document.getElementById('metodo-pago-carwash').value,
                    rnc: rnc || null
                };
                
                DB.add('sales_carwash', sale);
                
                cartCarwash = [];
                updateCartUICarwash();
                document.getElementById('efectivo-recibido-carwash').value = '0';
                document.getElementById('rnc-carwash').value = '';
                updateChangeCarwash();
            });

            // Imprimir ticket car wash
            document.getElementById('printTicketBtnCarwash').addEventListener('click', function() {
                if (cartCarwash.length === 0) {
                    showNotification('No hay productos en el carrito', 'error');
                    return;
                }
                
                printCarwashInvoice();
            });

            // Actualizar cambio car wash
            document.getElementById('efectivo-recibido-carwash').addEventListener('input', function() {
                updateChangeCarwash();
            });
        }

        // Funciones para carrito de barbería
        function addToCartBarberia(id, name, price) {
            const existingItem = cartBarberia.find(item => item.id === id);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cartBarberia.push({
                    id: id,
                    name: name,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartUIBarberia();
            showNotification(`${name} agregado al carrito`, 'success');
        }

        function updateCartUIBarberia() {
            const cartItems = document.getElementById('cartItemsBarberia');
            const cartCount = document.getElementById('cartCountBarberia');
            const cartTotal = document.getElementById('cartTotalBarberia');
            
            cartItems.innerHTML = '';
            let total = 0;

            cartBarberia.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">RD$ ${item.price} c/u</div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="quantity-btn decrease" data-id="${item.id}">-</button>
                        <span>${item.quantity}</span>
                        <button class="quantity-btn increase" data-id="${item.id}">+</button>
                    </div>
                    <div>RD$ ${itemTotal}</div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartCount.textContent = `${cartBarberia.length} productos`;
            cartTotal.textContent = `Total: RD$ ${total}`;

            // Event listeners para botones de cantidad
            document.querySelectorAll('#cartItemsBarberia .quantity-btn.increase').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cartBarberia.find(item => item.id === productId);
                    if (item) {
                        item.quantity++;
                        updateCartUIBarberia();
                        updateChangeBarberia();
                    }
                });
            });

            document.querySelectorAll('#cartItemsBarberia .quantity-btn.decrease').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cartBarberia.find(item => item.id === productId);
                    if (item && item.quantity > 1) {
                        item.quantity--;
                        updateCartUIBarberia();
                        updateChangeBarberia();
                    }
                });
            });

            updateChangeBarberia();
        }

        function getCartTotalBarberia() {
            return cartBarberia.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        }

        function updateChangeBarberia() {
            const total = getCartTotalBarberia();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido-barberia').value) || 0;
            const cambio = efectivo - total;
            
            const cambioDisplay = document.getElementById('cambio-display-barberia');
            
            if (cambio >= 0) {
                cambioDisplay.textContent = `Cambio: RD$ ${cambio}`;
                cambioDisplay.style.color = "var(--accent)";
            } else {
                cambioDisplay.textContent = `Faltan: RD$ ${Math.abs(cambio)}`;
                cambioDisplay.style.color = "var(--danger)";
            }
        }

        // Funciones para carrito de car wash
        function addToCartCarwash(id, name, price) {
            const existingItem = cartCarwash.find(item => item.id === id);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cartCarwash.push({
                    id: id,
                    name: name,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartUICarwash();
            showNotification(`${name} agregado al carrito`, 'success');
        }

        function updateCartUICarwash() {
            const cartItems = document.getElementById('cartItemsCarwash');
            const cartCount = document.getElementById('cartCountCarwash');
            const cartTotal = document.getElementById('cartTotalCarwash');
            
            cartItems.innerHTML = '';
            let total = 0;

            cartCarwash.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">RD$ ${item.price} c/u</div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="quantity-btn decrease" data-id="${item.id}">-</button>
                        <span>${item.quantity}</span>
                        <button class="quantity-btn increase" data-id="${item.id}">+</button>
                    </div>
                    <div>RD$ ${itemTotal}</div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartCount.textContent = `${cartCarwash.length} productos`;
            cartTotal.textContent = `Total: RD$ ${total}`;

            // Event listeners para botones de cantidad
            document.querySelectorAll('#cartItemsCarwash .quantity-btn.increase').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cartCarwash.find(item => item.id === productId);
                    if (item) {
                        item.quantity++;
                        updateCartUICarwash();
                        updateChangeCarwash();
                    }
                });
            });

            document.querySelectorAll('#cartItemsCarwash .quantity-btn.decrease').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cartCarwash.find(item => item.id === productId);
                    if (item && item.quantity > 1) {
                        item.quantity--;
                        updateCartUICarwash();
                        updateChangeCarwash();
                    }
                });
            });

            updateChangeCarwash();
        }

        function getCartTotalCarwash() {
            return cartCarwash.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        }

        function updateChangeCarwash() {
            const total = getCartTotalCarwash();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido-carwash').value) || 0;
            const cambio = efectivo - total;
            
            const cambioDisplay = document.getElementById('cambio-display-carwash');
            
            if (cambio >= 0) {
                cambioDisplay.textContent = `Cambio: RD$ ${cambio}`;
                cambioDisplay.style.color = "var(--accent)";
            } else {
                cambioDisplay.textContent = `Faltan: RD$ ${Math.abs(cambio)}`;
                cambioDisplay.style.color = "var(--danger)";
            }
        }

        // Funciones para carrito original (Billar)
        function addToCart(id, name, price) {
            const existingItem = cart.find(item => item.id === id);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartUI();
            showNotification(`${name} agregado al carrito`, 'success');
        }

        function updateCartUI() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">RD$ ${item.price} c/u</div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="quantity-btn decrease" data-id="${item.id}">-</button>
                        <span>${item.quantity}</span>
                        <button class="quantity-btn increase" data-id="${item.id}">+</button>
                    </div>
                    <div>RD$ ${itemTotal}</div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartCount.textContent = `${cart.length} productos`;
            cartTotal.textContent = `Total: RD$ ${total}`;

            // Event listeners para botones de cantidad
            document.querySelectorAll('.quantity-btn.increase').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cart.find(item => item.id === productId);
                    if (item) {
                        item.quantity++;
                        updateCartUI();
                        updateChange();
                    }
                });
            });

            document.querySelectorAll('.quantity-btn.decrease').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const item = cart.find(item => item.id === productId);
                    if (item && item.quantity > 1) {
                        item.quantity--;
                        updateCartUI();
                        updateChange();
                    }
                });
            });

            updateChange();
        }

        function getCartTotal() {
            return cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        }

        function updateChange() {
            const total = getCartTotal();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido').value) || 0;
            const cambio = efectivo - total;
            
            const cambioDisplay = document.getElementById('cambio-display');
            
            if (cambio >= 0) {
                cambioDisplay.textContent = `Cambio: RD$ ${cambio}`;
                cambioDisplay.style.color = "var(--accent)";
            } else {
                cambioDisplay.textContent = `Faltan: RD$ ${Math.abs(cambio)}`;
                cambioDisplay.style.color = "var(--danger)";
            }
        }

        // =============================================
        // SISTEMA DE BARBERÍA
        // =============================================

        function setupBarberia() {
            // Guardar cita
            document.getElementById('saveAppointmentBtn').addEventListener('click', function() {
                const nombre = document.getElementById('nombre').value;
                const telefono = document.getElementById('telefono').value;
                const servicio = document.getElementById('servicio').value;
                const precio = document.getElementById('precio').value;
                const fechaHora = document.getElementById('fecha-hora').value;
                
                if (!nombre || !servicio || !precio || !fechaHora) {
                    showNotification('Por favor complete todos los campos obligatorios', 'error');
                    return;
                }
                
                const appointment = {
                    nombre: nombre,
                    telefono: telefono,
                    servicio: servicio,
                    precio: precio,
                    fechaHora: fechaHora,
                    barbero: 'Antoni',
                    estado: 'pendiente',
                    fechaRegistro: new Date().toISOString()
                };
                
                DB.add('appointments', appointment);
                showNotification('Cita guardada correctamente', 'success');
                
                // Limpiar formulario
                document.getElementById('nombre').value = '';
                document.getElementById('telefono').value = '';
                document.getElementById('servicio').value = '';
                document.getElementById('precio').value = '';
                document.getElementById('fecha-hora').value = '';
                
                // Actualizar lista de citas
                loadAppointments();
            });

            // Imprimir factura barbería
            document.getElementById('printInvoiceBarberia').addEventListener('click', function() {
                printBarberiaInvoice();
            });

            // Buscar historial
            document.getElementById('searchHistoryBtn').addEventListener('click', function() {
                loadAppointmentsHistory();
            });
        }

        // =============================================
        // SISTEMA DE FACTURACIÓN CON RNC
        // =============================================

        function generateCardPaymentSection() {
            const fecha = new Date();
            const fechaStr = fecha.toLocaleDateString('es-ES', { weekday: 'short', day: '2-digit', month: 'short', year: 'numeric' }).toUpperCase();
            const horaStr = fecha.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit', second: '2-digit' }).toUpperCase();
            
            return `
                <div class="card-payment-section">
                    <div class="card-payment-header">OPERACIÓN ACEPTADA</div>
                    <div class="card-payment-details">
                        <div class="card-payment-detail">
                            <span class="card-payment-label">VENTA</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span class="card-payment-label">FECHA:</span>
                            <span>${fechaStr}</span>
                        </div>
                        <div class="card-payment-detail">
                            <span class="card-payment-label">HORA:</span>
                            <span>${horaStr}</span>
                        </div>
                    </div>
                    <div class="card-payment-details">
                        <div class="card-payment-detail">
                            <span class="card-number">53022200 ****** 3446</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>TT:MC sin contacto</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>MODO:PR L@5</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>TID:MPL69PB63</span>
                            <span>1130</span>
                        </div>
                        <div class="card-payment-detail">
                            <span>RRN: 533417000082</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>Mastercard</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>A0000000041010</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>TC - 3C10D38306AB625F</span>
                            <span></span>
                        </div>
                        <div class="card-payment-detail">
                            <span>NO REF:000021</span>
                            <span>&lt;&lt; DUPLICADO &gt;&gt;</span>
                        </div>
                    </div>
                    <div class="card-payment-approval">APROBACIÓN: 183817</div>
                    <div class="card-payment-details">
                        <div class="card-payment-detail">
                            <span>COMPRA:</span>
                            <span>RD$593.22</span>
                        </div>
                        <div class="card-payment-detail">
                            <span>ITBIS:</span>
                            <span>RD$106.78</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function printInvoice() {
            if (cart.length === 0) {
                showNotification('No hay productos en el carrito', 'error');
                return;
            }

            const total = getCartTotal();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido').value) || 0;
            const cambio = efectivo - total;
            const metodoPago = document.getElementById('metodo-pago').value;
            const rnc = document.getElementById('rnc').value;
            const formattedRNC = formatRNC(rnc);
            const itbis = total * 0.18;
            const subtotal = total - itbis;

            const invoiceContent = `
                <div class="invoice-header">
                    <div class="invoice-logo">STARK CLEANE</div>
                    <div class="invoice-company">BARBERÍA & BILLAR</div>
                    <div class="invoice-address">Av. Principal #123, Santo Domingo</div>
                    <div class="invoice-rnc">RNC: ${formattedRNC}</div>
                    <div class="invoice-details">
                        <div>Fecha: ${new Date().toLocaleDateString()}</div>
                        <div>Hora: ${new Date().toLocaleTimeString()}</div>
                        <div class="invoice-number">Ticket #${Date.now().toString().slice(-6)}</div>
                    </div>
                </div>
                <div class="invoice-items">
                    ${cart.map(item => `
                        <div class="invoice-item">
                            <span>${item.name} x${item.quantity}</span>
                            <span>RD$ ${item.price * item.quantity}</span>
                        </div>
                    `).join('')}
                </div>
                <div class="invoice-total">
                    <div class="invoice-item">
                        <span>Subtotal:</span>
                        <span>RD$ ${subtotal.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>ITBIS (18%):</span>
                        <span>RD$ ${itbis.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Total:</span>
                        <span>RD$ ${total}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Método de Pago:</span>
                        <span>${metodoPago}</span>
                    </div>
                    ${metodoPago === 'efectivo' ? `
                        <div class="invoice-item">
                            <span>Efectivo:</span>
                            <span>RD$ ${efectivo}</span>
                        </div>
                        <div class="invoice-item">
                            <span>Cambio:</span>
                            <span>RD$ ${cambio}</span>
                        </div>
                    ` : ''}
                </div>
                ${metodoPago === 'tarjeta' ? generateCardPaymentSection() : ''}
                <div class="invoice-footer">
                    <div>¡Gracias por su compra!</div>
                    <div>Vuelva pronto</div>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceContent;
            document.getElementById('invoiceModal').classList.add('active');
        }

        function printBarberiaInvoice() {
            const metodoPago = document.getElementById('metodo-pago-barberia').value;
            const total = getCartTotalBarberia();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido-barberia').value) || 0;
            const cambio = efectivo - total;
            const rnc = document.getElementById('rnc-barberia').value;
            const formattedRNC = formatRNC(rnc);
            const itbis = total * 0.18;
            const subtotal = total - itbis;

            const invoiceContent = `
                <div class="invoice-header">
                    <div class="invoice-logo">STARK CLEANE</div>
                    <div class="invoice-company">BARBERÍA ANTONI</div>
                    <div class="invoice-address">Av. Principal #123, Santo Domingo</div>
                    <div class="invoice-rnc">RNC: ${formattedRNC}</div>
                    <div class="invoice-details">
                        <div>Fecha: ${new Date().toLocaleDateString()}</div>
                        <div>Hora: ${new Date().toLocaleTimeString()}</div>
                        <div class="invoice-number">Factura #${Date.now().toString().slice(-6)}</div>
                    </div>
                </div>
                <div class="invoice-items">
                    ${cartBarberia.map(item => `
                        <div class="invoice-item">
                            <span>${item.name} x${item.quantity}</span>
                            <span>RD$ ${item.price * item.quantity}</span>
                        </div>
                    `).join('')}
                </div>
                <div class="invoice-total">
                    <div class="invoice-item">
                        <span>Subtotal:</span>
                        <span>RD$ ${subtotal.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>ITBIS (18%):</span>
                        <span>RD$ ${itbis.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Total:</span>
                        <span>RD$ ${total}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Método de Pago:</span>
                        <span>${metodoPago}</span>
                    </div>
                    ${metodoPago === 'efectivo' ? `
                        <div class="invoice-item">
                            <span>Efectivo:</span>
                            <span>RD$ ${efectivo}</span>
                        </div>
                        <div class="invoice-item">
                            <span>Cambio:</span>
                            <span>RD$ ${cambio}</span>
                        </div>
                    ` : ''}
                </div>
                ${metodoPago === 'tarjeta' ? generateCardPaymentSection() : ''}
                <div class="invoice-footer">
                    <div>¡Gracias por su preferencia!</div>
                    <div>Barbero: Antoni</div>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceContent;
            document.getElementById('invoiceModal').classList.add('active');
        }

        function printCarwashInvoice() {
            const metodoPago = document.getElementById('metodo-pago-carwash').value;
            const total = getCartTotalCarwash();
            const efectivo = parseFloat(document.getElementById('efectivo-recibido-carwash').value) || 0;
            const cambio = efectivo - total;
            const rnc = document.getElementById('rnc-carwash').value;
            const formattedRNC = formatRNC(rnc);
            const itbis = total * 0.18;
            const subtotal = total - itbis;

            const invoiceContent = `
                <div class="invoice-header">
                    <div class="invoice-logo">STARK CLEANE</div>
                    <div class="invoice-company">CAR WASH</div>
                    <div class="invoice-address">Av. Principal #123, Santo Domingo</div>
                    <div class="invoice-rnc">RNC: ${formattedRNC}</div>
                    <div class="invoice-details">
                        <div>Fecha: ${new Date().toLocaleDateString()}</div>
                        <div>Hora: ${new Date().toLocaleTimeString()}</div>
                        <div class="invoice-number">Factura #${Date.now().toString().slice(-6)}</div>
                    </div>
                </div>
                <div class="invoice-items">
                    ${cartCarwash.map(item => `
                        <div class="invoice-item">
                            <span>${item.name} x${item.quantity}</span>
                            <span>RD$ ${item.price * item.quantity}</span>
                        </div>
                    `).join('')}
                </div>
                <div class="invoice-total">
                    <div class="invoice-item">
                        <span>Subtotal:</span>
                        <span>RD$ ${subtotal.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>ITBIS (18%):</span>
                        <span>RD$ ${itbis.toFixed(2)}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Total:</span>
                        <span>RD$ ${total}</span>
                    </div>
                    <div class="invoice-item">
                        <span>Método de Pago:</span>
                        <span>${metodoPago}</span>
                    </div>
                    ${metodoPago === 'efectivo' ? `
                        <div class="invoice-item">
                            <span>Efectivo:</span>
                            <span>RD$ ${efectivo}</span>
                        </div>
                        <div class="invoice-item">
                            <span>Cambio:</span>
                            <span>RD$ ${cambio}</span>
                        </div>
                    ` : ''}
                </div>
                ${metodoPago === 'tarjeta' ? generateCardPaymentSection() : ''}
                <div class="invoice-footer">
                    <div>¡Gracias por su preferencia!</div>
                    <div>STARK CLEANE CAR WASH</div>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceContent;
            document.getElementById('invoiceModal').classList.add('active');
        }

        // Cerrar modal de factura
        document.getElementById('closeInvoiceModal').addEventListener('click', function() {
            document.getElementById('invoiceModal').classList.remove('active');
        });

        // Imprimir factura
        document.getElementById('printInvoiceBtn').addEventListener('click', function() {
            window.print();
        });

        // =============================================
        // SISTEMA JARVIS - IA INTELIGENTE
        // =============================================

        class JarvisAI {
            constructor() {
                this.recognition = null;
                this.isListening = false;
                this.commands = {
                    'abrir dashboard': () => showPage('dashboard'),
                    'abrir barbería': () => showPage('barberia'),
                    'abrir billar': () => showPage('billar'),
                    'abrir car wash': () => showPage('carwash'),
                    'nueva cita': () => this.createAppointment(),
                    'nuevo producto': () => this.createProduct(),
                    'registrar vehículo': () => this.createVehicle(),
                    'resumen del día': () => this.showDailySummary(),
                    'ayuda': () => this.showHelp(),
                    'hola jarvis': () => this.greet(),
                    'cerrar sesión': () => document.getElementById('logoutBtn').click()
                };
                this.init();
            }

            init() {
                this.setupSpeechRecognition();
                this.setupChat();
                this.setupVoiceActivation();
            }

            setupSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.lang = 'es-ES';
                    this.recognition.continuous = false;
                    this.recognition.interimResults = false;

                    this.recognition.onstart = () => {
                        this.isListening = true;
                        document.getElementById('jarvisButton').classList.add('listening');
                        this.addMessage('Escuchando...', 'jarvis');
                    };

                    this.recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript.toLowerCase();
                        this.addMessage(transcript, 'user');
                        this.processCommand(transcript);
                    };

                    this.recognition.onerror = (event) => {
                        console.error('Error en reconocimiento de voz:', event.error);
                        this.addMessage('Lo siento, no pude entender. ¿Podrías repetirlo?', 'jarvis');
                    };

                    this.recognition.onend = () => {
                        this.isListening = false;
                        document.getElementById('jarvisButton').classList.remove('listening');
                    };
                } else {
                    console.warn('El navegador no soporta reconocimiento de voz');
                }
            }

            setupChat() {
                const jarvisButton = document.getElementById('jarvisButton');
                const jarvisChat = document.getElementById('jarvisChat');
                const closeJarvis = document.getElementById('closeJarvis');
                const sendJarvis = document.getElementById('sendJarvis');
                const jarvisInput = document.getElementById('jarvisInput');

                jarvisButton.addEventListener('click', () => {
                    jarvisChat.classList.toggle('active');
                });

                closeJarvis.addEventListener('click', () => {
                    jarvisChat.classList.remove('active');
                });

                sendJarvis.addEventListener('click', () => {
                    const message = jarvisInput.value.trim();
                    if (message) {
                        this.addMessage(message, 'user');
                        this.processCommand(message.toLowerCase());
                        jarvisInput.value = '';
                    }
                });

                jarvisInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendJarvis.click();
                    }
                });
            }

            setupVoiceActivation() {
                // Tecla F2 para activar voz
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'F2') {
                        e.preventDefault();
                        this.startListening();
                    }
                });

                // Botón de micrófono
                document.getElementById('voiceKeyBtn').addEventListener('click', () => {
                    this.startListening();
                });
            }

            startListening() {
                if (this.recognition && !this.isListening) {
                    this.recognition.start();
                }
            }

            addMessage(text, sender) {
                const messages = document.getElementById('jarvisMessages');
                const message = document.createElement('div');
                message.className = `message ${sender}`;
                message.textContent = text;
                messages.appendChild(message);
                messages.scrollTop = messages.scrollHeight;
            }

            processCommand(command) {
                let executed = false;

                // Buscar comandos específicos
                for (const [cmd, action] of Object.entries(this.commands)) {
                    if (command.includes(cmd)) {
                        action();
                        this.addMessage(`Ejecutando: ${cmd}`, 'jarvis');
                        executed = true;
                        break;
                    }
                }

                // Comandos avanzados con parámetros
                if (command.includes('agregar producto')) {
                    this.processAddProduct(command);
                    executed = true;
                } else if (command.includes('buscar')) {
                    this.processSearch(command);
                    executed = true;
                } else if (command.includes('registrar cita')) {
                    this.processAppointment(command);
                    executed = true;
                }

                if (!executed) {
                    const responses = [
                        "No entendí ese comando. ¿Podrías ser más específico?",
                        "Lo siento, no reconozco ese comando. Prueba con 'ayuda' para ver los comandos disponibles.",
                        "No tengo implementada esa función aún. ¿Necesitas algo más?",
                        "Comando no reconocido. ¿Quieres que te muestre lo que puedo hacer?"
                    ];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    this.addMessage(response, 'jarvis');
                }
            }

            processAddProduct(command) {
                // Extraer nombre y precio del comando
                const match = command.match(/agregar producto (.+) precio (.+)/);
                if (match) {
                    const nombre = match[1];
                    const precio = match[2].replace(/[^\d]/g, '');
                    
                    this.addMessage(`Creando producto: ${nombre} por RD$ ${precio}`, 'jarvis');
                    showNotification(`Producto "${nombre}" agregado al inventario`, 'success');
                    
                    // Simular agregar producto
                    const product = {
                        nombre: nombre,
                        precio: parseInt(precio),
                        categoria: 'otros',
                        stock: 10,
                        fecha: new Date().toISOString()
                    };
                    
                    DB.add('products', product);
                }
            }

            processSearch(command) {
                const searchTerm = command.replace('buscar', '').trim();
                this.addMessage(`Buscando: ${searchTerm}`, 'jarvis');
                showNotification(`Búsqueda realizada para: ${searchTerm}`, 'info');
            }

            processAppointment(command) {
                const match = command.match(/registrar cita para (.+) con (.+)/);
                if (match) {
                    const cliente = match[1];
                    const barbero = match[2];
                    
                    this.addMessage(`Creando cita para ${cliente} con ${barbero}`, 'jarvis');
                    
                    // Simular creación de cita
                    const appointment = {
                        nombre: cliente,
                        barbero: barbero,
                        servicio: 'Corte de cabello',
                        precio: 250,
                        fechaHora: new Date().toISOString(),
                        estado: 'pendiente'
                    };
                    
                    DB.add('appointments', appointment);
                    showNotification(`Cita creada para ${cliente} con ${barbero}`, 'success');
                }
            }

            createAppointment() {
                showPage('barberia');
                this.addMessage('Abriendo módulo de barbería para crear cita', 'jarvis');
            }

            createProduct() {
                showPage('billar');
                // Activar modal de producto
                setTimeout(() => {
                    document.getElementById('addProductBtn').click();
                }, 500);
                this.addMessage('Abriendo inventario para agregar producto', 'jarvis');
            }

            createVehicle() {
                showPage('carwash');
                this.addMessage('Abriendo módulo de car wash para registrar vehículo', 'jarvis');
            }

            showDailySummary() {
                const sales = DB.get('sales');
                const appointments = DB.get('appointments');
                const vehicles = DB.get('vehicles');
                
                const totalSales = sales.reduce((sum, sale) => sum + sale.total, 0);
                const totalAppointments = appointments.length;
                const totalVehicles = vehicles.length;
                
                const summary = `
                    Resumen del día:
                    - Ventas: RD$ ${totalSales}
                    - Citas: ${totalAppointments}
                    - Vehículos: ${totalVehicles}
                    - Total ingresos estimados: RD$ ${totalSales + (totalAppointments * 250) + (totalVehicles * 300)}
                `;
                
                this.addMessage(summary, 'jarvis');
                showNotification('Resumen del día generado', 'info');
            }

            showHelp() {
                const helpText = `
                    Comandos disponibles:
                    - "Abrir [módulo]" - Navegar a cualquier módulo
                    - "Nueva cita" - Crear cita en barbería
                    - "Nuevo producto" - Agregar producto al inventario
                    - "Registrar vehículo" - Registrar vehículo en car wash
                    - "Resumen del día" - Ver reporte diario
                    - "Buscar [texto]" - Realizar búsqueda
                    - "Ayuda" - Mostrar esta ayuda
                    - "Cerrar sesión" - Salir del sistema
                `;
                
                this.addMessage(helpText, 'jarvis');
            }

            greet() {
                const greetings = [
                    "¡Hola! ¿En qué puedo ayudarte hoy?",
                    "¡Hola! Soy Jarvis, tu asistente inteligente. ¿Qué necesitas?",
                    "¡Hola! Listo para ayudarte. ¿Qué quieres hacer?",
                    "¡Hola! Bienvenido de nuevo. ¿En qué puedo asistirte?"
                ];
                const greeting = greetings[Math.floor(Math.random() * greetings.length)];
                this.addMessage(greeting, 'jarvis');
            }
        }

        // =============================================
        // INICIALIZACIÓN DEL SISTEMA
        // =============================================

        function initApp() {
            // Configurar navegación con event delegation
            document.addEventListener('click', function(event) {
                // Navegación por páginas desde el menú
                if (event.target.closest('[data-page]')) {
                    const pageElement = event.target.closest('[data-page]');
                    const pageId = pageElement.getAttribute('data-page');
                    
                    if (pageElement.classList.contains('submenu-item')) {
                        const parentSubmenu = pageElement.closest('.submenu');
                        if (parentSubmenu) {
                            parentSubmenu.classList.remove('active');
                            const parentMenuItem = parentSubmenu.previousElementSibling;
                            if (parentMenuItem) {
                                parentMenuItem.querySelector('.fa-chevron-down').classList.remove('fa-chevron-up');
                            }
                        }
                    }
                    
                    showPage(pageId);
                }
                
                if (event.target.closest('[data-submenu]')) {
                    const submenuElement = event.target.closest('[data-submenu]');
                    const submenuId = submenuElement.getAttribute('data-submenu') + '-submenu';
                    const submenu = document.getElementById(submenuId);
                    submenu.classList.toggle('active');
                    
                    const chevron = submenuElement.querySelector('.fa-chevron-down');
                    if (chevron) {
                        chevron.classList.toggle('fa-chevron-up');
                    }
                    
                    event.stopPropagation();
                }
            });

            // Configurar pestañas
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('tab')) {
                    const tab = event.target;
                    const tabId = tab.getAttribute('data-tab');
                    const container = tab.closest('.tabs').parentElement;
                    
                    tab.closest('.tabs').querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    tab.classList.add('active');
                    
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                }
            });

            // Configurar dashboard cards
            document.addEventListener('click', function(event) {
                if (event.target.closest('.card-system')) {
                    const card = event.target.closest('.card-system');
                    const pageId = card.getAttribute('data-page');
                    if (pageId) {
                        showPage(pageId);
                    }
                }
            });

            // Configurar carritos
            setupCartBillar();
            setupCartBarberia();
            setupCartCarwash();

            // Configurar barbería
            setupBarberia();

            // Configurar tema
            document.getElementById('themeToggle').addEventListener('click', function() {
                if (document.body.classList.contains('dark-mode')) {
                    document.body.classList.remove('dark-mode');
                    document.body.classList.add('light-mode');
                    this.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    document.body.classList.remove('light-mode');
                    document.body.classList.add('dark-mode');
                    this.innerHTML = '<i class="fas fa-moon"></i>';
                }
            });

            // Configurar hamburger menu
            document.querySelector('.hamburger').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('active');
            });

            // Configurar logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                document.getElementById('screen-login').style.display = 'flex';
                document.getElementById('mainSystem').style.display = 'none';
                showNotification('Sesión cerrada correctamente', 'success');
            });

            // Inicializar Jarvis AI
            window.jarvis = new JarvisAI();

            // Inicializar gráficos
            initializeCharts();
        }

        // =============================================
        // INICIALIZACIÓN DE GRÁFICOS
        // =============================================

        function initializeCharts() {
            // Gráfico de ventas
            const salesCtx = document.getElementById('salesChart');
            if (salesCtx) {
                new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'],
                        datasets: [{
                            label: 'Ventas Diarias',
                            data: [1200, 1900, 1500, 2300, 1800, 2500, 2200],
                            borderColor: '#1a73e8',
                            backgroundColor: 'rgba(26, 115, 232, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#e0e0e0'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#b0b0b0'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#b0b0b0'
                                }
                            }
                        }
                    }
                });
            }

            // Gráfico de categorías
            const categoryCtx = document.getElementById('categoryChart');
            if (categoryCtx) {
                new Chart(categoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Bebidas', 'Snacks', 'Licores', 'Otros'],
                        datasets: [{
                            data: [45, 25, 20, 10],
                            backgroundColor: [
                                '#1a73e8',
                                '#ff6d00',
                                '#00c853',
                                '#d32f2f'
                            ],
                            borderWidth: 2,
                            borderColor: '#1e1e1e'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#e0e0e0',
                                    padding: 20
                                }
                            }
                        }
                    }
                });
            }

            // Actualizar estadísticas del dashboard
            updateDashboardStats();
        }

        function updateDashboardStats() {
            // Simular datos
            document.getElementById('appointmentsCount').textContent = '8';
            document.getElementById('salesTotal').textContent = 'RD$ 2,450';
            document.getElementById('vehiclesCount').textContent = '5';
            document.getElementById('dailyIncome').textContent = 'RD$ 3,200';
            document.getElementById('customersCount').textContent = '23';
            document.getElementById('productsSold').textContent = '47';
            
            document.getElementById('appointmentsTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> 2 nuevas hoy';
            document.getElementById('salesTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> 15% más que ayer';
            document.getElementById('vehiclesTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> 1 en proceso';
            document.getElementById('incomeTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> RD$ 450 más que ayer';
            document.getElementById('customersTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> 5 nuevos clientes';
            document.getElementById('productsTrend').innerHTML = '<i class="fas fa-arrow-up trend-up"></i> 12 unidades vendidas';
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('screen-login').style.display = 'flex';
            
            // Enter para login
            loginPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    btnLogin.click();
                }
            });
            
            // Enter para registro
            registerConfirmPassword.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    btnRegister.click();
                }
            });
        });
    </script>
</body>
</html>